version: '3.5'
services:
  web:
    image: thing
    command: [web]
    entrypoint: [/entrypoint]
    env_file: ./env.string
    environment:
      PANDA: BEAR
      MSKEY: reg
    volumes:
      - 'deps:/deps'
  work:
    image: thing
    command: [work]
    entrypoint: [/entrypoint]
    env_file:
      - ./env.list
      - ./env.list.2
    environment:
      PANDA: BEAR
    volumes:
      - 'deps:/deps'
      - 'overdeps:/var/deps'
  ms:
    image: reg:2
    environment:
      OVERRIDE: "oh, the power!"
  store:
    build: ./store
    volumes:
      - 'storedata:/data'
      - type: bind
        source: './somedir'
        target: '/var/somedir'
      - type: bind
        source: '${MUSS_TEST_FILE_VOL:-./vol}/file'
        target: '/var/somefile'
        read_only: true
        consistency: cached
    command: [init]
volumes:
  storedata: {}
  overdeps: {}
